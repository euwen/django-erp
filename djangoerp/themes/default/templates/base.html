{% load i18n %}
{% load staticfiles %}
{% load regions %}

{% language user.language|default:LANGUAGE_CODE %}
{% get_current_language as lang_code %}
{% get_current_language_bidi as lang_bidi %}

<!DOCTYPE html>
<html lang="{{ lang_code }}"{% if lang_bidi %} dir="rtl"{% endif %}>
    <head>
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta charset="{% block meta-charset %}utf-8{% endblock %}">
        <meta name="viewport" content="{% block meta-viewport %}width=device-width, initial-scale=1{% endblock %}">
        <meta name="description" content="{% block meta-description %}{% endblock %}">
        <link rel="icon" href="{% block meta-favicon %}{% static 'favicon.ico' %}{% endblock %}">

        <title>{% trans 'django ERP' %} |{% block meta-title %}{% endblock %}</title>

        <link rel="stylesheet" href="{% static 'css/font-awesome.min.css' %}"/>
        <link rel="stylesheet" href="{% static 'css/bootstrap.min.css' %}"/>
        <link rel="stylesheet" href="{% static 'css/bootstrap-datetimepicker.min.css' %}"/>
        <link rel="stylesheet" href="{% static 'css/datatables.min.css' %}" />
        <link rel="stylesheet" href="{% static 'css/animate.min.css' %}" />

        <link rel="stylesheet" href="{% static 'css/screen.css' %}"/>
        {% if lang_bidi %}<link rel="stylesheet" href="{% static 'css/rtl.css' %}"/>{% endif %}
        <link rel="stylesheet" href="{% static 'css/print.css' %}" media="print">

        {% block extrastyles %}
        {% endblock %}

        <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
          <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
          <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
        <![endif]-->

        {% block extraforms %}
            {% if form %}{{ form.media }}{% endif %}
            {% if wizard %}{{ wizard.form.media }}{% endif %}
            {% if media %}{{ media }}{% endif %}
        {% endblock %}

        {% block extrahead %}
        {% endblock %}
    </head>

    <body class="{% block body-class %}{% endblock %}">
        <div id="wrapper" class="{% block wrapper-class %}{% endblock %}">
            {% block wrapper %}
            {% endblock %}

            {% block extrascripts %}
            <script src="{% static 'js/jquery.min.js' %}"></script>
            <script src="{% static 'js/bootstrap.min.js' %}"></script>
            <script src="{% static 'js/bootstrap-datetimepicker.js' %}"></script>
            <script src="{% static 'js/bootstrap-wysiwyg.js' %}"></script>
            <script src="{% static 'js/datatables.min.js' %}"></script>
            {% endblock %}

            {% block onbodyload %}
            <script>
                // Bootstrap DateTime Pickers.

                initDateTimePickers: function(lang_code) {
                    var self = this;

                    var icons = {
                        time: 'fa fa-clock-o fa-fw',
                        date: 'fa fa-calendar fa-fw',
                        up:   'fa fa-chevron-up fa-fw',
                        down: 'fa fa-chevron-down fa-fw'
                    }

                    $('.input-datetimepicker')
                        .datetimepicker({
                            icons: icons,
                            language: lang_code || "en",
                        });

                    $('.input-datepicker')
                        .datetimepicker({
                            icons: icons,
                            language: lang_code || "en",
                            pickTime: false,
                        });

                    $('.input-timepicker')
                        .datetimepicker({
                            icons: icons,
                            language: lang_code || "en",
                            pickDate: false,
                        });
                },

                // Bootstrap WYSIWYG Editor.

                initWYSIWYGEditors: function() {
                    var self = this;

                    function syncEditor(e) {
                        var editor = $(this);
                        var textarea_id = editor.attr("id").slice(0,-7);
                        var textarea = $("#" + textarea_id);

                        textarea.val(editor.cleanHtml());

                        return false;
                    }

                    $(".wysiwyg-editor")
                        .wysiwyg();

                    $(".wysiwyg-editor")
                        .off('change', syncEditor)
                        .on('change', syncEditor);
                },
            </script>
            {% endblock %}
        </div>
    </body>

</html>

{% endlanguage %}
